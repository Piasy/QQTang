<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="zh">
<head>
<!-- Generated by javadoc (version 1.7.0_21) on Fri Dec 13 10:13:28 CST 2013 -->
<title>HallModel</title>
<meta name="date" content="2013-12-13">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="HallModel";
    }
//-->
</script>
<noscript>
<div>您的浏览器已禁用 JavaScript。</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="跳过导航链接"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../../../../overview-summary.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../../deprecated-list.html">已过时</a></li>
<li><a href="../../../../index-all.html">索引</a></li>
<li><a href="../../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/example/client/model/GameModel.html" title="com.example.client.model中的类"><span class="strong">上一个类</span></a></li>
<li><a href="../../../../com/example/client/model/Room.html" title="com.example.client.model中的类"><span class="strong">下一个类</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/example/client/model/HallModel.html" target="_top">框架</a></li>
<li><a href="HallModel.html" target="_top">无框架</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">所有类</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li>嵌套&nbsp;|&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">构造器</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">构造器</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">方法</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">com.example.client.model</div>
<h2 title="类 HallModel" class="title">类 HallModel</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>com.example.client.model.HallModel</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="strong">HallModel</span>
extends java.lang.Object</pre>
<div class="block"><p>This class is the model in the MVC design pattern, the hall model.
 It takes charge of all communication with hall server, upholding 
 the hall information, which include the room information, users information
 and so on, and giving all information when necessary.</p>
 
 <p>Our basic assumption is that once the data has been sent
 to here, it must be json format. Because the TCP has error
 check mechanism. The user self is also a common user, 
 so I won't treat him specially.</p> 
  
 <p>author:     Piasy Xu</p>
 <p>date:               21:25 2013/12/11</p>
 <p>email:      xz4215@gmail.com</p>
 <p>github:     Piasy</p></div>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>构造器概要</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="构造器概要表, 列表构造器和解释">
<caption><span>构造器</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">构造器和说明</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../com/example/client/model/HallModel.html#HallModel(java.lang.String, int, java.lang.String, java.lang.String, Handler)">HallModel</a></strong>(java.lang.String&nbsp;hallIP,
         int&nbsp;hallPort,
         java.lang.String&nbsp;username,
         java.lang.String&nbsp;key,
         Handler&nbsp;controllerHandler)</code>
<div class="block">public constructor, set the server info, connection info, and controller handler</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>方法概要</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="方法概要表, 列表方法和解释">
<caption><span>方法</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">限定符和类型</th>
<th class="colLast" scope="col">方法和说明</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#connectToHallServer()">connectToHallServer</a></strong>()</code>
<div class="block">After the socket and other tools are prepared,
 this method will do the first interaction communication
 with hall server, to exchange the identification,
 and also receive the initial hall information
 from it, which will be used by viewer once 
 the player has signed in successfully.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#createSocket()">createSocket</a></strong>()</code>
<div class="block">Create socket ,BufferedReader, and
 PrintWriter before all works, to 
 avoid the scenario that these tools
 are used whiles they are not
 prepared.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#getCurrentMessage(int)">getCurrentMessage</a></strong>(int&nbsp;length)</code>
<div class="block">Get talk messages.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>java.lang.String</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#getHallSnapShot(int, int)">getHallSnapShot</a></strong>(int&nbsp;startRoomNum,
               int&nbsp;endRoomNum)</code>
<div class="block">Get the detail info of given range rooms.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>JSONObject</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#getMyDetails()">getMyDetails</a></strong>()</code>
<div class="block">Get user self details info</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#getMyRoomNum()">getMyRoomNum</a></strong>()</code>
<div class="block">Get current room number of user</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#handleEvents(java.lang.String)">handleEvents</a></strong>(java.lang.String&nbsp;rcvStr)</code>
<div class="block">Handle messages from server.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#init()">init</a></strong>()</code>
<div class="block">initialize socket, read, and writer; connect to hall
 server, and receive the initial hall info.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#listen()">listen</a></strong>()</code>
<div class="block">Listen to hall server, and parse events receive from server,
 manage the hall info, including rooms info
 and users info.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#readTimeOut()">readTimeOut</a></strong>()</code>
<div class="block">once socket timeout, return to login</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#sendEnterMSG(int, int)">sendEnterMSG</a></strong>(int&nbsp;roomNum,
            int&nbsp;seatPos)</code>
<div class="block">Send enter message to hall server.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#sendLeaveMSG()">sendLeaveMSG</a></strong>()</code>
<div class="block">Send leave message
 The message is send as json format string.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#sendReadyMSG()">sendReadyMSG</a></strong>()</code>
<div class="block">Send ready message
 The message is send as json format string.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#sendSignoutMSG()">sendSignoutMSG</a></strong>()</code>
<div class="block">Signout method.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#sendTalkMessage(java.lang.String)">sendTalkMessage</a></strong>(java.lang.String&nbsp;message)</code>
<div class="block">Send talk messages to hall server.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#sendUnreadyMsg()">sendUnreadyMsg</a></strong>()</code>
<div class="block">Send unready message
 The message is send as json format string.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>protected void</code></td>
<td class="colLast"><code><strong><a href="../../../../com/example/client/model/HallModel.html#updateHallSnapShot()">updateHallSnapShot</a></strong>()</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>从类继承的方法&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>构造器详细资料</h3>
<a name="HallModel(java.lang.String, int, java.lang.String, java.lang.String, Handler)">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>HallModel</h4>
<pre>public&nbsp;HallModel(java.lang.String&nbsp;hallIP,
         int&nbsp;hallPort,
         java.lang.String&nbsp;username,
         java.lang.String&nbsp;key,
         Handler&nbsp;controllerHandler)</pre>
<div class="block">public constructor, set the server info, connection info, and controller handler</div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>server</code> - info, connection info, and controller handler</dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>方法详细资料</h3>
<a name="init()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>init</h4>
<pre>public&nbsp;boolean&nbsp;init()</pre>
<div class="block">initialize socket, read, and writer; connect to hall
 server, and receive the initial hall info.
 Create socket ,BufferedReader, and
 PrintWriter before all works, to 
 avoid the scenario that these tools
 are used whiles they are not
 prepared.</div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>none</code> - </dd>
<dt><span class="strong">返回:</span></dt><dd>none</dd></dl>
</li>
</ul>
<a name="listen()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>listen</h4>
<pre>public&nbsp;void&nbsp;listen()</pre>
<div class="block">Listen to hall server, and parse events receive from server,
 manage the hall info, including rooms info
 and users info.</div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>none</code> - </dd></dl>
</li>
</ul>
<a name="getMyDetails()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMyDetails</h4>
<pre>public&nbsp;JSONObject&nbsp;getMyDetails()</pre>
<div class="block">Get user self details info</div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>none</code> - </dd>
<dt><span class="strong">返回:</span></dt><dd>JSONObject, user self details</dd></dl>
</li>
</ul>
<a name="getMyRoomNum()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMyRoomNum</h4>
<pre>public&nbsp;int&nbsp;getMyRoomNum()</pre>
<div class="block">Get current room number of user</div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>none</code> - </dd>
<dt><span class="strong">返回:</span></dt><dd>current room number of user, -1 if not in any one</dd></dl>
</li>
</ul>
<a name="sendSignoutMSG()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendSignoutMSG</h4>
<pre>public&nbsp;void&nbsp;sendSignoutMSG()</pre>
<div class="block">Signout method.
 It won't send message to hall server any more, due to the change of 
 hall server, just stop the listening thread, and cancel the
 heart beat packet send task.</div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>none</code> - </dd></dl>
</li>
</ul>
<a name="sendEnterMSG(int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendEnterMSG</h4>
<pre>public&nbsp;void&nbsp;sendEnterMSG(int&nbsp;roomNum,
                int&nbsp;seatPos)</pre>
<div class="block">Send enter message to hall server.
 The message is send as json format string.
 For more information, please see the wiki page
 {client and hall server}.
 The server's response won't be returned immediately
 by this method, but will be transmitted via handler
 of android.</div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>roomNum,</code> - seatPos</dd></dl>
</li>
</ul>
<a name="sendLeaveMSG()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendLeaveMSG</h4>
<pre>public&nbsp;void&nbsp;sendLeaveMSG()</pre>
<div class="block">Send leave message
 The message is send as json format string.
 For more information, please see the wiki page
 {client and hall server}.
 The server's response won't be returned immediately
 by this method, but will be transmitted via handler
 of android.</div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>none</code> - </dd></dl>
</li>
</ul>
<a name="sendReadyMSG()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendReadyMSG</h4>
<pre>public&nbsp;void&nbsp;sendReadyMSG()</pre>
<div class="block">Send ready message
 The message is send as json format string.
 For more information, please see the wiki page
 {client and hall server}.
 The server's response won't be returned immediately
 by this method, but will be transmitted via handler
 of android.</div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>none</code> - </dd></dl>
</li>
</ul>
<a name="sendUnreadyMsg()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendUnreadyMsg</h4>
<pre>public&nbsp;void&nbsp;sendUnreadyMsg()</pre>
<div class="block">Send unready message
 The message is send as json format string.
 For more information, please see the wiki page
 {client and hall server}.
 The server's response won't be returned immediately
 by this method, but will be transmitted via handler
 of android.</div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>none</code> - </dd></dl>
</li>
</ul>
<a name="getHallSnapShot(int, int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getHallSnapShot</h4>
<pre>public&nbsp;java.lang.String&nbsp;getHallSnapShot(int&nbsp;startRoomNum,
                               int&nbsp;endRoomNum)</pre>
<div class="block">Get the detail info of given range rooms.
 These information will be used by viewer to
 draw the hall view and room view. They are
 presented in json format. For more information, 
 please see the wiki page {Client Viewer And Controller Interface}.
 PLEASE NOTE: If the arguments are invalid, this method will 
 return a null pointer, so before you use it, check whether 
 the return value is null at first. That will make this software
 more robust. 
 change: pageNum -> room range</div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>[startRoomNum,</code> - endRoomNum]</dd>
<dt><span class="strong">返回:</span></dt><dd>json format string, if params are 
 invalid, null will be returned</dd></dl>
</li>
</ul>
<a name="getCurrentMessage(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCurrentMessage</h4>
<pre>public&nbsp;java.lang.String&nbsp;getCurrentMessage(int&nbsp;length)</pre>
<div class="block">Get talk messages.
 The return value will be presented in json format.
 For more information, please see the wiki page 
 {Client Talk Interface}.</div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>message</code> - count</dd>
<dt><span class="strong">返回:</span></dt><dd>json format string</dd></dl>
</li>
</ul>
<a name="sendTalkMessage(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>sendTalkMessage</h4>
<pre>public&nbsp;void&nbsp;sendTalkMessage(java.lang.String&nbsp;message)</pre>
<div class="block">Send talk messages to hall server.
 The message is send as json format string.
 For more information, please see the wiki page
 {client and hall server}. These messages will
 be available when calling the getCurrentMessage(int length)
 method after messages are sent to client by hall
 server.</div>
<dl><dt><span class="strong">参数:</span></dt><dd><code>message</code> - to send</dd></dl>
</li>
</ul>
<a name="handleEvents(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>handleEvents</h4>
<pre>protected&nbsp;void&nbsp;handleEvents(java.lang.String&nbsp;rcvStr)</pre>
<div class="block">Handle messages from server.
 Different type has different way. But the first 
 principle is to design this software for robust.
 Any data from the outside of this model will
 be validated before using. If there has any
 invalid data, this software will turn to the proper
 status according to the level of error.</div>
</li>
</ul>
<a name="createSocket()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createSocket</h4>
<pre>protected&nbsp;boolean&nbsp;createSocket()</pre>
<div class="block">Create socket ,BufferedReader, and
 PrintWriter before all works, to 
 avoid the scenario that these tools
 are used whiles they are not
 prepared.</div>
</li>
</ul>
<a name="connectToHallServer()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>connectToHallServer</h4>
<pre>protected&nbsp;boolean&nbsp;connectToHallServer()</pre>
<div class="block">After the socket and other tools are prepared,
 this method will do the first interaction communication
 with hall server, to exchange the identification,
 and also receive the initial hall information
 from it, which will be used by viewer once 
 the player has signed in successfully.</div>
</li>
</ul>
<a name="readTimeOut()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>readTimeOut</h4>
<pre>protected&nbsp;void&nbsp;readTimeOut()</pre>
<div class="block">once socket timeout, return to login</div>
</li>
</ul>
<a name="updateHallSnapShot()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>updateHallSnapShot</h4>
<pre>protected&nbsp;void&nbsp;updateHallSnapShot()</pre>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="跳过导航链接"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="导航">
<li><a href="../../../../overview-summary.html">概览</a></li>
<li><a href="package-summary.html">程序包</a></li>
<li class="navBarCell1Rev">类</li>
<li><a href="package-tree.html">树</a></li>
<li><a href="../../../../deprecated-list.html">已过时</a></li>
<li><a href="../../../../index-all.html">索引</a></li>
<li><a href="../../../../help-doc.html">帮助</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../com/example/client/model/GameModel.html" title="com.example.client.model中的类"><span class="strong">上一个类</span></a></li>
<li><a href="../../../../com/example/client/model/Room.html" title="com.example.client.model中的类"><span class="strong">下一个类</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?com/example/client/model/HallModel.html" target="_top">框架</a></li>
<li><a href="HallModel.html" target="_top">无框架</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">所有类</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>概要:&nbsp;</li>
<li>嵌套&nbsp;|&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">构造器</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">方法</a></li>
</ul>
<ul class="subNavList">
<li>详细资料:&nbsp;</li>
<li>字段&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">构造器</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">方法</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
